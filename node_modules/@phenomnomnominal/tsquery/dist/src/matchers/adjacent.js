"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Dependencies:
var match_1 = require("../match");
var traverse_1 = require("../traverse");
// Constants:
var LEFT = 'left';
var RIGHT = 'right';
function adjacent(node, selector, ancestry) {
    return match_1.findMatches(node, selector.right, ancestry) &&
        findAdjacent(node, selector.left, ancestry, LEFT) ||
        selector.right.subject &&
            match_1.findMatches(node, selector.left, ancestry) &&
            findAdjacent(node, selector.right, ancestry, RIGHT);
}
exports.adjacent = adjacent;
function findAdjacent(node, selector, ancestry, side) {
    var parent = ancestry[0];
    if (!parent) {
        return false;
    }
    var keys = traverse_1.getVisitorKeys(node.parent || null);
    return keys.some(function (key) {
        var prop = node.parent[key];
        if (Array.isArray(prop)) {
            var index = prop.indexOf(node);
            if (index === -1) {
                return false;
            }
            if (side === LEFT && index > 0 && match_1.findMatches(prop[index - 1], selector, ancestry)) {
                return true;
            }
            if (side === RIGHT && index < prop.length - 1 && match_1.findMatches(prop[index + 1], selector, ancestry)) {
                return true;
            }
        }
        return false;
    });
}
//# sourceMappingURL=adjacent.js.map